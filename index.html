<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Human vs AI Tic Tac Toe</title>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0; padding: 0;
      text-align: center;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
    }

    h1 { margin: 20px 0; font-size: 2.5em; }

    /* Welcome Screen */
    #welcome {
      display: flex; flex-direction: column;
      justify-content: center; align-items: center;
      height: 100vh;
      background: url("https://i.ibb.co/sWY8Ttv/robot-bg.jpg") center/cover no-repeat;
    }
    #welcome h1 { color: #fff; text-shadow: 2px 2px 6px #000; }
    #startBtn {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: 20px;
      border: none;
      border-radius: 8px;
      background: #ff9800;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    }
    #startBtn:hover { background: #e68900; }

    /* Game Container */
    #gameContainer { display: none; padding: 20px; }

    #modeToggle {
      margin: 10px; padding: 8px 16px;
      border: none; border-radius: 6px;
      background: #03a9f4; color: white;
      font-size: 16px; cursor: pointer;
    }
    #modeToggle:hover { background: #0288d1; }

    #board {
      display: grid;
      grid-template-columns: repeat(3, 120px);
      gap: 6px;
      justify-content: center;
      margin: 20px auto;
    }
    .cell {
      width: 120px; height: 120px;
      font-size: 48px; font-weight: bold;
      display: flex; align-items: center; justify-content: center;
      border-radius: 12px;
      background: #fff; color: #000;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: background 0.3s;
    }
    .cell:hover { background: #f1f1f1; }
    .cell.taken { cursor: not-allowed; color: #444; background: #ddd; }

    #aiChoices {
      display: none;
      margin: 20px auto;
    }
    .choiceGrid {
      display: grid;
      grid-template-columns: repeat(3, 60px);
      gap: 5px;
      justify-content: center;
    }
    .choiceBtn {
      width: 60px; height: 60px;
      border: 2px solid #fff;
      border-radius: 8px;
      background: rgba(255,255,255,0.2);
      color: #fff; font-size: 18px;
      cursor: pointer;
    }
    .choiceBtn.selected { background: #ff5722; }

    #message {
      margin-top: 20px;
      font-size: 20px; font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Welcome Screen -->
  <div id="welcome">
    <h1>ðŸ¤– Welcome to Human vs AI Tic Tac Toe</h1>
    <p>AI needs your input... always.</p>
    <button id="startBtn">Start Game</button>
  </div>

  <!-- Game Container -->
  <div id="gameContainer">
    <h1>Human vs AI Tic Tac Toe</h1>
    <button id="modeToggle">Switch to Guided Mode</button>
    <div id="aiChoices">
      <p>Select squares the AI can use:</p>
      <div class="choiceGrid"></div>
    </div>
    <div id="board"></div>
    <div id="message">Your turn!</div>
  </div>

  <script>
    const welcome = document.getElementById("welcome");
    const gameContainer = document.getElementById("gameContainer");
    const boardEl = document.getElementById("board");
    const msgEl = document.getElementById("message");
    const aiChoicesEl = document.getElementById("aiChoices");
    const modeToggleBtn = document.getElementById("modeToggle");
    const choiceGrid = document.querySelector(".choiceGrid");

    let board, gameActive, human = "X", ai = "O";
    let mode = "normal"; // "normal" or "guided"
    let allowedSquares = [];

    // Show game on Start
    document.getElementById("startBtn").addEventListener("click", () => {
      welcome.style.display = "none";
      gameContainer.style.display = "block";
      resetBoard();
    });

    // Build game board
    for (let i = 0; i < 9; i++) {
      let cell = document.createElement("div");
      cell.classList.add("cell");
      cell.dataset.index = i;
      cell.addEventListener("click", humanMove);
      boardEl.appendChild(cell);
    }

    // Build 3x3 choice grid
    for (let i = 0; i < 9; i++) {
      let btn = document.createElement("button");
      btn.textContent = i+1;
      btn.classList.add("choiceBtn");
      btn.dataset.index = i;
      btn.addEventListener("click", toggleChoice);
      choiceGrid.appendChild(btn);
    }

    function toggleChoice(e) {
      const idx = parseInt(e.target.dataset.index);
      if (allowedSquares.includes(idx)) {
        allowedSquares = allowedSquares.filter(i => i !== idx);
        e.target.classList.remove("selected");
      } else {
        allowedSquares.push(idx);
        e.target.classList.add("selected");
      }
    }

    function humanMove(e) {
      if (!gameActive) return;
      let idx = e.target.dataset.index;
      if (board[idx]) return; 
      makeMove(idx, human);

      if (checkWinner(human)) return endRound("ðŸŽ‰ You win!");
      if (board.every(c => c)) return endRound("Draw! No one wins.");

      setTimeout(aiMove, 400);
    }

    function aiMove() {
      if (!gameActive) return;
      let empties = board.map((c, i) => c ? null : i).filter(v => v !== null);

      let move;
      if (mode === "guided") {
        let filtered = empties.filter(i => allowedSquares.includes(i));
        if (filtered.length === 0) return endRound("AI has no allowed moves â€” Human input required!");
        move = filtered[Math.floor(Math.random() * filtered.length)];
      } else {
        move = smartAIMove(empties);
      }

      makeMove(move, ai);

      if (checkWinner(ai)) return endRound("ðŸ¤– AI wins!");
      if (board.every(c => c)) return endRound("Draw! No one wins.");
    }

    // Smart AI: win > block > center > corners > sides
    function smartAIMove(empties) {
      // Try winning
      for (let i of empties) {
        let copy = [...board]; copy[i] = ai;
        if (checkWinner(ai, copy)) return i;
      }
      // Block human
      for (let i of empties) {
        let copy = [...board]; copy[i] = human;
        if (checkWinner(human, copy)) return i;
      }
      // Center
      if (empties.includes(4)) return 4;
      // Corners
      let corners = empties.filter(i => [0,2,6,8].includes(i));
      if (corners.length) return corners[Math.floor(Math.random()*corners.length)];
      // Sides
      return empties[Math.floor(Math.random()*empties.length)];
    }

    function makeMove(idx, player) {
      board[idx] = player;
      let cell = document.querySelector(`.cell[data-index="${idx}"]`);
      cell.textContent = player;
      cell.classList.add("taken");
    }

    function checkWinner(player, state = board) {
      const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      return wins.some(pattern => pattern.every(i => state[i] === player));
    }

    function endRound(message) {
      msgEl.textContent = message + " â€” Restartingâ€¦";
      gameActive = false;
      setTimeout(resetBoard, 1500);
    }

    function resetBoard() {
      board = Array(9).fill(null);
      document.querySelectorAll(".cell").forEach(c => {
        c.textContent = "";
        c.classList.remove("taken");
      });
      allowedSquares = [];
      document.querySelectorAll(".choiceBtn").forEach(b => b.classList.remove("selected"));
      gameActive = true;
      msgEl.textContent = "Your turn!";
    }

    // Toggle modes
    modeToggleBtn.addEventListener("click", () => {
      mode = (mode === "normal") ? "guided" : "normal";
      resetBoard();
      if (mode === "guided") {
        aiChoicesEl.style.display = "block";
        modeToggleBtn.textContent = "Switch to Normal Mode";
        msgEl.textContent = "Select squares for the AI before playing!";
      } else {
        aiChoicesEl.style.display = "none";
        modeToggleBtn.textContent = "Switch to Guided Mode";
        msgEl.textContent = "Your turn!";
      }
    });
  </script>
</body>
</html>


